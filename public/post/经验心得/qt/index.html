<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>因为qt的问题，害得我kde桌面都不能用了，改用gnome桌面 - 啃魂的寒舍</title><meta name=description content="欢迎光临啃魂的个人博客，他的完本作品有：《龙珠之超级宗师》、《天龙天外天》（又名《书虫成神记》）、《猪妖传》、《悟道天龙》、《幸福武侠》。他已经研究写作很长时间了，相信很快就会有新作品出来。"><meta name=keywords content="啃魂,龙珠之超级宗师,天龙天外天,书虫成神记,猪妖传,悟道天龙,幸福武侠"><meta name=author content><meta property="og:type" content="website"><meta property="og:title" content="因为qt的问题，害得我kde桌面都不能用了，改用gnome桌面"><meta property="og:description" content="欢迎光临啃魂的个人博客，他的完本作品有：《龙珠之超级宗师》、《天龙天外天》（又名《书虫成神记》）、《猪妖传》、《悟道天龙》、《幸福武侠》。他已经研究写作很长时间了，相信很快就会有新作品出来。"><meta property="og:url" content="/post/%E7%BB%8F%E9%AA%8C%E5%BF%83%E5%BE%97/qt/"><meta property="og:site_name" content="啃魂的寒舍"><meta name=twitter:card content="summary_large_image"><link rel=canonical href=/post/%E7%BB%8F%E9%AA%8C%E5%BF%83%E5%BE%97/qt/><link rel=alternate type=application/rss+xml href=/index.xml title=啃魂的寒舍><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/scss/style.min.6c6d9343cf04c23912b250a6104d4e303b07c33eac875e9fd0b1593b909b43b9.css integrity="sha256-bG2TQ88EwjkSslCmEE1OMDsHwz6sh16f0LFZO5CbQ7k=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css><link rel=preload as=image href=/images/hero><link rel=icon type=image/x-icon href=/favicon.ico><script type=importmap>
  {
    "imports": {
      "firebase/app": "https://www.gstatic.com/firebasejs/10.9.0/firebase-app.js",
      "firebase/database": "https://www.gstatic.com/firebasejs/10.9.0/firebase-database.js"
    }
  }
  </script></head><body><header class=site-header><div class=header-container><nav class="main-navigation navbar navbar-expand-lg navbar-light bg-light"><div class="collapse nav-collapse"><ul class="nav nav-item"><li class="nav-item active"><a class=nav-link href=/>首页</a></li><li class="nav-item has-dropdown"><a href=/post class=nav-link aria-haspopup=true aria-expanded=false>文章</a><div class=dropdown role=menu><a class=dropdown-item href=/post>短篇</a>
<a class=dropdown-item href=/posts>连载</a>
<a class=dropdown-item href=/categories>分类</a>
<a class=dropdown-item href=/tags>标签</a>
<a class=dropdown-item href=/archive>归档</a></div></li><li class="nav-item has-dropdown"><a href=/themes class=nav-link aria-haspopup=true aria-expanded=false>主题</a><div class=dropdown role=menu><a class=dropdown-item href=/themes>介绍</a>
<a class=dropdown-item href=/downloads>下载</a></div></li><li class=nav-item><a class=nav-link href=/about>关于</a></li><li class=nav-item><a class=nav-link href=/contact>联系</a></li></ul></div></nav><script src=/js/search.js></script><ul class=search-form><div class=search-form><div id=search class=search-container><input type=text id=search-input onkeyup=search(this.value) placeholder=搜索文章...></div><script>var indexJsonUrl="/index.json"</script></div></ul></div></header><script>document.querySelectorAll(".nav-item.has-dropdown").forEach(e=>{const t=e.querySelector(".nav-link"),s=e.querySelector(".dropdown");window.matchMedia("(max-width: 768px)").matches&&t.addEventListener("click",t=>{window.getComputedStyle(s).display==="none"&&(t.preventDefault(),e.classList.toggle("is-open"))}),t.addEventListener("keydown",e=>{if(e.key==="ArrowDown"||e.key==="ArrowUp"){e.preventDefault();const t=s.querySelectorAll(".dropdown-item"),n=t[0],o=t[t.length-1];e.key==="ArrowDown"?n.focus():e.key==="ArrowUp"&&o.focus()}});const n=s.querySelectorAll(".dropdown-item");n.forEach((e,s)=>{e.addEventListener("keydown",e=>{e.key==="ArrowUp"?(e.preventDefault(),s===0?t.focus():n[s-1].focus()):e.key==="ArrowDown"?(e.preventDefault(),s===n.length-1?t.focus():n[s+1].focus()):e.key==="Escape"&&t.focus()})})}),document.querySelectorAll(".dropdown-item").forEach(e=>{e.addEventListener("click",()=>{if(window.matchMedia("(max-width: 768px)").matches){const n=e.closest(".dropdown"),t=e.closest(".nav-item");n&&t&&t.classList.remove("is-open")}})})</script><div class=container><div class=row><div class=col-md-8><main id=main><div id=search-results class=search-results></div><article class=post-single><header class=post-header><h1 class=post-title>因为qt的问题，害得我kde桌面都不能用了，改用gnome桌面</h1><div class=post-meta><span class=reading-time>阅读时间：3 分钟</span>
<span class=word-count>字数：1469</span></div><div class=post-terms><div class=post-categories><span class=term-title>分类：</span>
<a href=/categories/%E7%BB%8F%E9%AA%8C%E5%BF%83%E5%BE%97/ class=category-link>经验心得</a></div></div></header><div class=post-content><h2 id=202437>2024.3.7</h2><p>弄了好几天，才勉强把qt的问题给解决，却又不急着换回kde桌面了。</p><p>qt的问题主要有两个：</p><ol><li><p>qt5和qt6之间的冲突。</p></li><li><p>so不同版本的控制。</p></li></ol><ul><li>先说so不同版本的控制。</li></ul><p>so不同版本的后缀不同，so后面第一个后缀是大版本，是核心，例如so.1或so.2。后面的后缀是小版本，大部分时候不用去管。我就去爱管，结果不但浪费了大量时间，还引发了更严重的问题。</p><p>so的大版本控制得比较好，可以同时存在，不必考虑是删除这一个，还是留下这一个，不存在这种选择性困难。完全可以同时安装。例如：一个需要so.74，一个需要so.73，完全可以把74版和73版本都装上。</p><p>小版本不讲究控制，程序只知去调用大版本，却不知大版本是链接到了哪个小版本。例如：A程序和B程序都调用到so.73，但A程序需要的是so.73.1，而B程序需要的是so.73.2。假设现在只安装了so.73.1，A程序因此运行良好，B程序不是不能运行，只是会有些瑕疵，比如说窗口最大化后不见右上角的那些控制按钮了。</p><p><strong>紧记：删除so前一定要先备份一段时间，不然想再找回就麻烦了。一个很小的so都可能引发连锁反应，造成系统雪崩式的灾难。</strong></p><ul><li>再说qt5和qt6之间的冲突。</li></ul><p>这个没什么好的方案。两者之间最好只装一个，要么qt5，要么qt6。如果硬要一起装，就只装一个系统级，另一个用户级。两者在系统级层面混淆在一起，将会是灾难性的。</p><p>我把qt6卸载后装在/home/yoli2/qt/qt6</p><p>为什么不卸载qt5？因为与qt5关联在一起的程序太多了，卸载的时候要一起卸载。卸载qt6的话，先把那些一起卸载掉的程序的名字记下来，以后再装上。</p><ul><li>环境变量的配置</li></ul><p>原来我是在/etc/profile和~/.xprofile里面都有配置qt的环境变量，后来发现最好还是只在/etc/profile文件里配置最好。</p><div class=chroma data-lang=code><pre tabindex=0>
    <code class=language-code># qt
# retext需要再加上qt6的插件路径，否则打开retext后不能输入汉字。这解决方法在网上找不到答案，纯粹是自己实验出来。
# ----------------------------------------------------qt----------------------------------------------------
export XDG_RUNTIME_DIR=~/xdg/runtime
export RUNLEVEL=3
export QT_QPA_PLATFORM=xcb
#export QT_QPA_PLATFORM=wayland
export QT_QPA_FONTDIR=/opt/fonts
export QT_AUTO_SCREEN_SCALE_FACTOR=0
export QT_DEBUG_PLUGINS=1
#export QT_LOGGING_RULES=qt.qpa.*=true
#export QSG_INFO=1
#export QT_QPA_EGLFS_DEBUG=1
# ----------------------------------------------------qt6----------------------------------------------------
#export PATH=/home/yoli2/qt/qt6/bin:$PATH
#export PKG_CONFIG_PATH=/home/yoli2/qt/qt6/lib/pkgconfig
#export LD_LIBRARY_PATH=/home/yoli2/qt/qt6 # 指定共享库的加载路径，LD_LIBRARY_PATH优先于path环境变量。
#export QT_PLUGIN_PATH=/home/yoli2/qt/qt6/plugins
#export QT_QPA_PLATFORM_PLUGIN_PATH=/home/yoli2/qt/qt6/plugins
#export QT_QPA_PLATFORMTHEME="qt6ct"
# ----------------------------------------------------qt5----------------------------------------------------
export QT_SELECT=5
export Qt5_DIR=/lib/cmake/Qt5
export LD_LIBRARY_PATH=/lib
export QT_PLUGIN_PATH="" # 把原来的清除，否则容易混淆在一起。
export QT_PLUGIN_PATH=/lib/qt/plugins
export QT_QPA_PLATFORMM_PLUGIN_PATH="" # 把旧的清除，否则容易混淆在一起。
export QT_QPA_PLATFORMTHEME="qt5ct"</code>
  </pre></div><h3 id=最终解决方案>最终解决方案</h3><p>/etc/profile</p><div class=chroma data-lang=code><pre tabindex=0>
    <code class=language-code># qt
# retext需要再加上qt6的插件路径，否则打开retext后不能输入汉字。这解决方法在网上找不到答案，纯粹是自己实验出来。
# ----------------------------------------------------qt----------------------------------------------------
export XDG_RUNTIME_DIR=~/xdg/runtime
export RUNLEVEL=3
export QT_QPA_PLATFORM=xcb
#export QT_QPA_PLATFORM=wayland
export QT_QPA_FONTDIR=/opt/fonts
export QT_AUTO_SCREEN_SCALE_FACTOR=0
export QT_DEBUG_PLUGINS=1
#export QT_LOGGING_RULES=qt.qpa.*=true
#export QSG_INFO=1
#export QT_QPA_EGLFS_DEBUG=1
# ----------------------------------------------------qt6----------------------------------------------------
alias setqt6="export PATH=/bin/qt6:/lib/qt6/bin:$PATH && export LD_LIBRARY_PATH=/lib:/lib/qt6 && export QT_PLUGIN_PATH=/lib/qt6/plugins && PKG_CONFIG_PATH=/lib/qt6/pkgconfig && export QT_QPA_PLATFORMTHEME="qt6ct""
# ----------------------------------------------------qt5----------------------------------------------------
alias setqt5="export PATH=/bin/qt5:$PATH && export LD_LIBRARY_PATH=/lib && export QT_QPA_PLATFORMTHEME="qt5ct" && export QT_PLUGIN_PATH="" && export QT_QPA_PLATFORMM_PLUGIN_PATH="" && export PKG_CONFIG_PATH="" "
export PATH=/bin/qt5:$PATH
export LD_LIBRARY_PATH=/lib
#export QT_SELECT=5
#export Qt5_DIR=/lib/cmake/Qt5
#export QT_PLUGIN_PATH=""
#export QT_PLUGIN_PATH=/lib/qt/plugins</code>
  </pre></div><ul><li><p>解决思路：把不同版本的qmake分开放，给不同版本的设置起个别名。</p><p>在/bin目录下新建两个目录：qt5和qt6。</p><p>把/bin下面的qmake给移走。移走前用<code>qmake --version</code>查看是哪个版本。</p></li><li><p>测试结果：qt5和qt6程序甚至可以同时运行（不知是什么原因造成的），偶尔有不能运行的只用一个版本也不能运行。</p></li></ul><h2 id=202438>2024.3.8</h2><p>今天改了一下~/.xprofile文件，在里面增加了一段：</p><div class=chroma data-lang=code><pre tabindex=0>
    <code class=language-code># py
export LD_LIBRARY_PATH=/home/yoli/.local/lib/python3.11/site-packages/PyQt6/Qt6/lib:$LD_LIBRARY_PATH</code>
  </pre></div><p>然后把系统目录下的pyqt6给卸载了，暂时先只用用户目录下的pyqt6，这样配置起来更轻松。</p><div class=chroma data-lang=code><pre tabindex=0>
    <code class=language-code>sudo pip3 uninstall pyqt6
pip3 install pyqt6</code>
  </pre></div><p>这样配置后，重启终端或<code>source ~/.xprofile</code>，一些原本不能运行的qt6程序就又可以运行了。</p><p>这样配置后有一点小bug：每次用setqt5或setqt6改变配置后，都需要重启终端或<code>source ~/.xprofile</code>，否则那些原本不能运行的qt6程序就又不能运行了。</p></div><div class=disqus-container><section id=comments><h3>评论</h3><form method=POST action=https://staticman-repo.onrender.com/v3/entry/github/yolialisproxy/staticman-repo/main/comments><input type=hidden name=options[redirect] value=/post/%E7%BB%8F%E9%AA%8C%E5%BF%83%E5%BE%97/qt/#comment-submitted>
<input type=hidden name=options[slug] value=qt><p><label for=name>姓名 *:</label>
<input type=text name=fields[name] id=name required></p><p><label for=email>邮箱（不会公开） *:</label>
<input type=email name=fields[email] id=email required></p><p><label for=comment>评论 *:</label>
<textarea name=fields[comment] id=comment required rows=5></textarea></p><p><input type=submit value=提交></p></form><div id=comment-submitted style=display:none><h3>感谢提交！</h3><p>评论已提交，待审核通过后显示。</p></div></section></div><nav class=post-nav><div class=post-nav-prev><a href=/post/%E7%BB%8F%E9%AA%8C%E5%BF%83%E5%BE%97/pgp%E7%AD%BE%E5%90%8D%E9%AA%8C%E8%AF%81/ rel=prev><span class=post-nav-label>← 上一篇</span>
<span class=post-nav-title>在Manjaro Linux系统中遇到“无法提交处理 (无效或已损坏的软件包 (PGP 签名))”的错误</span></a></div><div class=post-nav-next><a href=/post/my-first-post/ rel=next><span class=post-nav-label>下一篇 →</span>
<span class=post-nav-title>今天第一次使用hugo构建自己的博客</span></a></div></nav></article></main></div><div class=col-md-4><aside class=sidebar><div class="widget author-widget"><div class="author-avatar author-info"><table><thead><tr><th style=text-align:left><img src=/images/avatar.jpg loading=lazy></th><th style=text-align:center>作者：啃魂</th></tr></thead><tbody></tbody></table><p>《幸福武侠》被禁好久了，有空就修改，一直有在改，一直没通过。后来终于有编辑告诉了我原因，主要有两个，一主角结婚的年龄早了些，二母女兼收。有兴趣的朋友可以去‘起点中文网’看一下我写的长篇网络小说：</p><table><thead><tr><th><a class=link href=https://book.qidian.com/info/3077613/ target=_blank rel=noopener>《悟道天龙》</a></th></tr></thead><tbody><tr><td><a class=link href=https://www.qidian.com/Book/1006684093.aspx target=_blank rel=noopener>《龙珠之超级宗师》</a></td></tr></tbody></table></div><div class=author-social><a href=https://github.com/yolialisproxy class=social-link target=_blank title=GitHub><i class="fab fa-github"></i>
</a><a href=mailto:yoli_alis@2925.com class=social-link target=_blank title=Email><i class="fas fa-envelope"></i>
</a><a href=https://t.me/kenhunshuchong class=social-link target=_blank title><i class="fas fa-telegram"></i></a></div></div><div class="widget recent-posts-widget"><h3 class=widget-title>最新文章</h3><ul class=recent-posts-list><li class=recent-post-item><a href=/post/%E6%B5%8B%E8%AF%95/ class=recent-post-title>我的测试文章</a>
<time class=recent-post-date>08-15</time></li><li class=recent-post-item><a href=/posts/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0/ class=recent-post-title>我的第一篇文章</a>
<time class=recent-post-date>08-10</time></li><li class=recent-post-item><a href=/themes/%E7%B4%AB%E9%9F%B5%E6%B5%85%E7%B4%AB%E4%B8%BB%E9%A2%98/ class=recent-post-title>紫韵浅紫主题</a>
<time class=recent-post-date>08-10</time></li><li class=recent-post-item><a href=/porrtfolio/%E4%BD%9C%E5%93%81%E9%9B%86/ class=recent-post-title>作品集</a>
<time class=recent-post-date>08-10</time></li><li class=recent-post-item><a href=/tutorial/%E6%95%99%E7%A8%8B/ class=recent-post-title>教程</a>
<time class=recent-post-date>08-10</time></li></ul></div><div class="widget tags-widget"><h3 class=widget-title>热门标签</h3><div class=widget-tags><a href=/tags/hugo/ class=widget-tag>Hugo
<span class=tag-count>39</span>
</a><a href=/tags/%E5%8D%9A%E5%AE%A2/ class=widget-tag>博客
<span class=tag-count>2</span>
</a><a href=/tags/%E6%B5%8B%E8%AF%95/ class=widget-tag>测试
<span class=tag-count>2</span>
</a><a href=/tags/blog/ class=widget-tag>Blog"
<span class=tag-count>1</span>
</a><a href=/tags/minimal/ class=widget-tag>Minimal
<span class=tag-count>1</span>
</a><a href=/tags/responsive/ class=widget-tag>Responsive
<span class=tag-count>1</span>
</a><a href=/tags/theme/ class=widget-tag>Theme
<span class=tag-count>1</span>
</a><a href=/tags/%E4%B8%BB%E9%A2%98/ class=widget-tag>主题
<span class=tag-count>1</span></a></div></div><div class="widget archive-widget"><h3 class=widget-title>文章归档</h3><ul class=archive-list><li class=archive-item><a href=/archive#2025-08>2025-08 (10)</a></li><li class=archive-item><a href=/archive#0001-01>0001-01 (43)</a></li></ul></div></aside></div></div></div><footer class=site-footer><div class=footer-container><div class=footer-content><p>&copy; 2025 啃魂 保留所有权利。</p></div><div class=social-links><a href=https://github.com/yolialisproxy target=_blank rel="noopener noreferrer">GitHub</a>
<a href=mailto:yoli_alis@2925.com target=_blank rel="noopener noreferrer">Email</a>
<a href=https://t.me/kenhunshuchong target=_blank rel="noopener noreferrer"></a></div></div></footer><script type=module src=https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js></script><script type=module src=https://code.jquery.com/jquery-3.5.1.slim.min.js></script><script type=module src=https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js></script><script type=module src=https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js></script><script type=module src=/js/search.js></script><script type=module src=/js/firebaseio.js></script><script type=module src=/js/comment-form.js></script></body></html>